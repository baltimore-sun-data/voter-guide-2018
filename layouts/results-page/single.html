{{ define "extra-head" }}
  <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/css/select2.min.css" rel="stylesheet" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/js/select2.min.js"></script>
{{ end }}

{{ define "main" }}
<div class="container">
    <h1 class="section-header-splash grey">{{.Title}}</h1>
    <main class="results-page">
        {{ .Content }}
    </main>

    <noscript>
      <h2>Warning: This page requires Javascript.</h2>
    </noscript>

    {{ partial "ad-autorefresh.html" . }}

    {{ $baseURL := .Param "results-base-url" }}
    <div
        class="js-results-container"
        data-fetch-url='{{.Param "results-base-url" }}1.html'
        data-target="#info"
        data-errors="#errors"
        data-time="#time"
        data-timeout="30000">

        {{ range .Site.Data.KeyContests2018Primary }}
          <button
            type="button"
            class="js-key-contests-btn"
            value="{{ $baseURL }}{{ .ID }}.html">
              {{- .Name -}}
          </button>
        {{ end }}

        <button type="button" class="js-key-contests-btn">Refresh</button>

        <select class="all-contests js-select2">
          <option disabled selected>Choose by race name</option>
          {{ range .Site.Data.results.AllContests }}
            <option value='{{ $baseURL }}{{ .ID }}.html'>
              {{- .Name -}}
              {{- if ne .Jurisdiction "State of Maryland" -}}
                {{- " " -}}{{- .Jurisdiction -}}
              {{- end -}}
              {{- if ne .District "State of Maryland" -}}
                {{- " " -}}{{- .District -}}
              {{- end -}}
              {{- if and (ne .Party "Non-Partisan") (ne .Party "Non Partisan") -}}
                {{- " " -}}({{- .Party -}})
              {{- end -}}
            </option>
          {{ end }}
        </select>

        <select class="all-options js-select2">
          <option disabled selected>Choose by candidate name</option>
          {{ range sort .Site.Data.results.AllOptions }}
            <option value='{{ $baseURL }}{{ .ID }}.html'>
              {{- .Name -}}
              {{- " • " }}{{ .Contest -}}
              {{- " • " }}{{ .District -}}
            </option>
          {{ end }}
        </select>

        <div class="last-refresh">
          Page last refreshed: <span id="time">Still loading…</span>
        </div>
        <div id="errors"></div>
        <div id="info">
          <p>Loading results…</p>
        </div>

        <div class="newsfeed">
          <!-- TODO: Get proper election day results feed URL -->
          <ul
              data-feed-url="http://www.baltimoresun.com/news/maryland/politics/rss2.0.xml"
              data-refresh="60000">
          </ul>
        </div>
    </div>
</div>
{{ end }}

