<script type="text/javascript">
var gptadslots = [];
var googletag = googletag || {};
googletag.cmd = googletag.cmd || [];

document.addEventListener("DOMContentLoaded", function(event) {
  function each(qs, callback) {
    var els = typeof qs === "string" ? document.querySelectorAll(qs) : qs;
    var i;
    for (i = 0; i < els.length; i++) {
      callback(els[i], i);
    }
  }

  var adUnit = "/4011/trb.baltimoresun/news/local/politics";

  each("[data-slot-sizes]", function(el, n) {
    // Create inner div
    var divId = "ad-unit-" + n.toString();
    var slot = document.createElement("div");
    slot.id = divId;
    slot.classList.add("slot");
    el.appendChild(slot);

    // Create ad mappings
    var sizes = JSON.parse(el.getAttribute("data-slot-sizes"));
    var viewports = JSON.parse(el.getAttribute("data-slot-viewports"));

    googletag.cmd.push(function() {
      var mapping = googletag.sizeMapping();
      sizes.forEach(function(size, i) {
        mapping.addSize(viewports[i], size);
      });
      mapping = mapping.build();

      // Push ad call
      var slot = googletag
        .defineSlot(adUnit, mapping, divId)
        .defineSizeMapping(mapping)
        .setTargeting("pos", ["1"])
        .setCollapseEmptyDiv(true)
        .addService(googletag.pubads());
      gptadslots.push(slot);
      googletag.pubads().setTargeting("ptype", ["s"]);
      googletag.enableServices();
      googletag.display(divId);

      // If we're supposed to refresh this periodically, do that
      var refreshInterval = el.getAttribute("data-refresh");
      if (refreshInterval) {
        window.adIntervalTimer = window.setInterval(function() {
          window.googletag.cmd.push(function() {
            window.googletag.pubads().refresh([slot]);
          });
        }, refreshInterval);
      }
    });
  });
});
</script>
<script src="//www.googletagservices.com/tag/js/gpt.js" async></script>
